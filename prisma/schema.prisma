generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Region {
  id     Int     @id
  name   String
  code   String
  prices Price[]
  orgs   Org[]

  @@map("regions")
}

model Product {
  id     Int     @id @default(autoincrement())
  name   String
  prices Price[]

  @@map("products")
}

model Org {
  id        Int    @id @default(autoincrement())
  name      String
  trade     Trade  @default(w)
  regionId  Int
  legalAddr String

  region Region @relation(fields: [regionId], references: [id], onDelete: Cascade)

  @@map("orgs")
}

enum Trade {
  w
  r
}

model Price {
  id        Int   @id @default(autoincrement())
  productId Int
  regionId  Int
  price     Float

  product Product @relation(fields: [productId], references: [id], onDelete: Cascade)
  region  Region  @relation(fields: [regionId], references: [id], onDelete: Cascade)

  @@unique([productId, regionId])
  @@map("prices")
}
